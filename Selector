package com.example.myapplication;

import androidx.appcompat.app.AppCompatActivity;
import android.os.Bundle;
import android.view.View;
import android.widget.*;

public class MainActivity extends AppCompatActivity implements AdapterView.OnItemSelectedListener {

    Spinner sp;
    LinearLayout itemContainer;
    ImageView imgSelected;

    String[] categories = {"Select Option", "Fruit", "Flower"};

    String[] fruits = {"Apple", "Banana", "Mango"};
    int[] fruitImages = {R.drawable.apple, R.drawable.banana, R.drawable.mango};

    String[] flowers = {"Rose", "Lily", "Sunflower"};
    int[] flowerImages = {R.drawable.rose, R.drawable.lily, R.drawable.sunflower};

    boolean firstLoad = true;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        sp = findViewById(R.id.sp);
        itemContainer = findViewById(R.id.itemContainer);
        imgSelected = findViewById(R.id.img);

        ArrayAdapter<String> adapter = new ArrayAdapter<>(this,
                android.R.layout.simple_spinner_item, categories);
        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        sp.setAdapter(adapter);
        sp.setOnItemSelectedListener(this);

        itemContainer.setVisibility(View.GONE);
        imgSelected.setVisibility(View.GONE);
    }

    @Override
    public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {
        if (firstLoad) {  // to ignore the automatic call on startup
            firstLoad = false;
            return;
        }

        itemContainer.removeAllViews();
        imgSelected.setVisibility(View.GONE);
        itemContainer.setVisibility(View.GONE);

        String selected = categories[position];

        if (selected.equals("Fruit")) {
            showButtons(fruits, fruitImages);
        } else if (selected.equals("Flower")) {
            showButtons(flowers, flowerImages);
        }
    }

    @Override
    public void onNothingSelected(AdapterView<?> parent) { }

    private void showButtons(String[] names, int[] images) {
        itemContainer.setVisibility(View.VISIBLE);

        for (int i = 0; i < names.length; i++) {
            final int index = i;
            Button btn = new Button(this);
            btn.setText(names[i]);
            btn.setAllCaps(false);

            btn.setOnClickListener(v -> {
                imgSelected.setVisibility(View.VISIBLE);
                imgSelected.setImageResource(images[index]);
                Toast.makeText(MainActivity.this,
                        "You selected: " + names[index], Toast.LENGTH_SHORT).show();
            });

            itemContainer.addView(btn);
        }
    }
}





<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:padding="20dp"
    android:gravity="center_horizontal">

    <Spinner
        android:id="@+id/sp"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

    <LinearLayout
        android:id="@+id/itemContainer"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:layout_marginTop="20dp"
        android:visibility="gone" />

    <ImageView
        android:id="@+id/img"
        android:layout_width="200dp"
        android:layout_height="200dp"
        android:layout_marginTop="30dp"
        android:scaleType="centerCrop"
        android:visibility="gone" />
</LinearLayout>

